// Accessible Calendar Overrides
// WCAG 2.1 AA Compliant Calendar Styling
@use 'theme' as *;

// Override problematic white text colors in modern-calendar.scss
.modern-calendar-container {
  // Remove dark theme styling
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  backdrop-filter: none;
  box-shadow: var(--shadow-md);
  
  .calendar-header {
    border-bottom: 1px solid var(--color-border);
    
    .calendar-title {
      h3 {
        color: var(--color-text-primary) !important; // Override white text
        font-weight: var(--font-weight-bold);
      }
      
      .calendar-subtitle {
        color: var(--color-text-secondary) !important; // Override white text
      }
    }
    
    .calendar-legend {
      .legend-item {
        color: var(--color-text-secondary) !important; // Override white text
      }
    }
  }
  
  .calendar-footer {
    .week-stats {
      border-top: 1px solid var(--color-border);
      
      .stat-item {
        .stat-label {
          color: var(--color-text-secondary) !important; // Override white text
        }
      }
    }
  }
}

.modern-day-card {
  // Remove glassmorphism dark theme styling
  background: var(--color-surface) !important;
  border: 1px solid var(--color-border) !important;
  backdrop-filter: none !important;
  box-shadow: var(--shadow-sm);
  
  &:hover {
    background: rgba(0, 102, 204, 0.02) !important; // Light primary color tint
    box-shadow: var(--shadow-md);
    border-color: var(--color-primary-hover);
    transform: translateY(-2px); // Reduced movement for accessibility
  }
  
  // Today highlighting with accessible colors
  &.today {
    background: rgba(0, 102, 204, 0.05) !important; // Light primary background
    border-color: var(--color-primary);
    box-shadow: 0 0 0 1px rgba(0, 102, 204, 0.2);
    
    .date-number {
      color: var(--color-primary) !important;
    }
  }
  
  // Center day styling
  &.center-day {
    background: rgba(0, 102, 204, 0.03) !important;
    border: 2px solid var(--color-primary);
    box-shadow: var(--shadow-lg);
    
    &:hover {
      box-shadow: var(--shadow-xl);
    }
  }
  
  // Status-based styling with accessible colors
  &.completed {
    border-left: 4px solid var(--color-success);
    
    .status-indicator {
      background: rgba(0, 178, 111, 0.1);
      color: #006B42; // High contrast green text
    }
  }
  
  &.planned {
    border-left: 4px solid var(--color-primary);
    
    .status-indicator {
      background: rgba(0, 102, 204, 0.1);
      color: var(--color-primary);
    }
  }
  
  &.missed {
    border-left: 4px solid var(--color-warning);
    
    .status-indicator {
      background: rgba(255, 176, 32, 0.1);
      color: var(--color-warning-text);
    }
  }
  
  &.rest-day {
    border-left: 4px solid var(--color-border);
    
    .status-indicator {
      background: rgba(0, 0, 0, 0.05);
      color: var(--color-text-secondary);
    }
  }
  
  .day-header {
    .date-info {
      .day-name {
        color: var(--color-text-secondary) !important; // Override white text
        font-weight: var(--font-weight-medium);
        text-transform: uppercase;
        font-size: 0.75rem;
        letter-spacing: 0.05em;
      }
      
      .date-number {
        color: var(--color-text-primary) !important; // Override white text
        font-weight: var(--font-weight-bold);
        font-size: 1.5rem;
      }
      
      .month-name {
        color: var(--color-text-secondary) !important; // Override white text
        font-size: 0.75rem;
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }
    }
  }
  
  .day-content {
    .workout-item {
      color: var(--color-text-primary);
      
      .workout-type {
        color: var(--color-text-secondary);
        font-size: var(--font-size-small);
      }
      
      .workout-duration {
        color: var(--color-text-secondary);
        font-weight: var(--font-weight-medium);
      }
    }
  }
}

// Override any other white text in calendar elements
.workout-calendar {
  color: var(--color-text-primary);
  
  * {
    // Reset any hardcoded white colors
    &[style*="color: #fff"],
    &[style*="color: white"],
    &[style*="color: rgba(255, 255, 255"] {
      color: var(--color-text-primary) !important;
    }
  }
  
  // Loading state
  .calendar-loading {
    color: var(--color-text-secondary);
    text-align: center;
    padding: var(--spacing-8);
  }
}

// Ensure high contrast for all calendar text elements
.calendar-title,
.calendar-subtitle,
.legend-item,
.day-name,
.date-number,
.month-name,
.stat-label,
.workout-type,
.workout-duration {
  // Force override any inline white text styles
  &[style*="color"] {
    color: var(--color-text-primary) !important;
  }
}

// Reduced motion support
@media (prefers-reduced-motion: reduce) {
  .modern-day-card {
    transition: none !important;
    
    &:hover {
      transform: none !important;
    }
  }
}

// Training Plan and Workout Card Accessibility Fixes
.workout-card {
  // Override glassmorphism dark theme styling
  background: var(--color-surface) !important;
  border: 1px solid var(--color-border) !important;
  box-shadow: var(--shadow-sm);
  
  &:hover {
    background: rgba(0, 102, 204, 0.02) !important; // Light primary tint
    box-shadow: var(--shadow-md);
    border-color: var(--color-primary-hover);
    transform: translateY(-2px);
  }
  
  // Center day styling with accessible colors
  &.center-day {
    background: rgba(0, 102, 204, 0.03) !important;
    border: 2px solid var(--color-primary) !important;
    box-shadow: var(--shadow-lg);
    
    &:hover {
      background: rgba(0, 102, 204, 0.05) !important;
      box-shadow: var(--shadow-xl);
    }
  }
  
  // Text color fixes
  .workout-date {
    color: var(--color-text-secondary) !important; // Override white text
    font-weight: var(--font-weight-medium);
  }
  
  .workout-type {
    color: var(--color-primary) !important; // Keep primary color
    font-weight: var(--font-weight-bold);
  }
  
  .workout-description {
    color: var(--color-text-primary) !important; // Override white text
  }
  
  .workout-duration,
  .workout-stats {
    color: var(--color-text-secondary) !important; // Override white text
  }
  
  // Status border colors - keep existing colored borders but ensure text is readable
  &.has-actual {
    border-left: 4px solid var(--color-success);
  }
  
  &.planned-only {
    border-left: 4px solid var(--color-warning);
  }
  
  &.missed-workout {
    border-left: 4px solid var(--color-error);
  }
  
  // Any nested text elements
  * {
    // Reset any hardcoded white colors
    &[style*="color: #fff"],
    &[style*="color: white"],
    &[style*="color: rgba(255, 255, 255"] {
      color: var(--color-text-primary) !important;
    }
  }
}

// Generated plan section styling
.generated-plan-section,
.plan-config-section,
.readiness-summary,
.plan-calendar {
  // Override dark theme glassmorphism
  background: var(--color-surface) !important;
  border: 1px solid var(--color-border) !important;
  backdrop-filter: none !important;
  color: var(--color-text-primary) !important;
  
  // Fix all text colors
  h3, h4, h5, h6 {
    color: var(--color-text-primary) !important;
  }
  
  .plan-meta,
  .readiness-indicators .indicator,
  .recommendations-list li,
  .warnings-list li,
  .legend-item,
  .workout-date,
  .workout-description,
  .workout-duration,
  .fatigue-value {
    color: var(--color-text-secondary) !important;
  }
  
  .readiness-score-large,
  .workout-type {
    color: var(--color-primary) !important;
  }
}

// Import drawer text fixes
.data-import-drawer {
  background: var(--color-surface) !important;
  border-left: 1px solid var(--color-border) !important;
  backdrop-filter: none !important;
  
  .drawer-header h3 {
    color: var(--color-primary) !important;
  }
  
  .close-drawer-btn {
    color: var(--color-text-secondary) !important;
    
    &:hover {
      color: var(--color-text-primary) !important;
    }
  }
}

// Performance metrics text fixes
.performance-metrics .performance-item {
  border-bottom: 1px solid var(--color-border) !important;
  
  .metric-label {
    color: var(--color-text-secondary) !important;
  }
  
  .metric-value {
    color: var(--color-text-primary) !important;
  }
}

// Workout Detail Panel/Popup Accessibility Fixes
.workout-detail-panel {
  // Override dark theme glassmorphism
  background: var(--color-surface) !important;
  border-left: 2px solid var(--color-border) !important;
  backdrop-filter: none !important;
  
  .panel-header {
    background: var(--color-surface) !important;
    border-bottom: 2px solid var(--color-border) !important;
    
    h3 {
      color: var(--color-primary) !important; // Keep primary color for title
    }
    
    .close-panel-btn {
      background: rgba(0, 0, 0, 0.05) !important;
      border: 1px solid var(--color-border) !important;
      color: var(--color-text-secondary) !important;
      
      &:hover {
        background: rgba(0, 0, 0, 0.1) !important;
        color: var(--color-text-primary) !important;
      }
    }
  }
}

// Workout Comparison Content Fixes
.workout-comparison-content {
  // Fix all white text in comparison content
  h4, h5, h6 {
    color: var(--color-text-primary) !important;
  }
  
  .comparison-header {
    background: var(--color-surface) !important;
    border: 1px solid var(--color-border) !important;
    
    .workout-status .status-text {
      &:not(.planned):not(.completed):not(.unplanned):not(.missed) {
        color: var(--color-text-primary) !important; // Override default white
      }
      
      // Keep status-specific colors for semantic meaning
      &.planned { color: var(--color-primary) !important; }
      &.completed { color: var(--color-success) !important; }
      &.unplanned { color: var(--color-warning-text) !important; }
      &.missed { color: var(--color-error) !important; }
    }
    
    .workout-date .date-text {
      color: var(--color-text-secondary) !important;
    }
  }
  
  // Fix section content text
  .planned-section,
  .actual-section,
  .comparison-stats,
  .workout-notes,
  .workout-insights {
    background: var(--color-surface) !important;
    border: 1px solid var(--color-border) !important;
    
    h5 {
      color: var(--color-text-primary) !important;
    }
    
    p, span, div {
      color: var(--color-text-primary) !important;
    }
    
    .label,
    .metric-label {
      color: var(--color-text-secondary) !important;
    }
    
    .value,
    .metric-value {
      color: var(--color-text-primary) !important;
    }
  }
  
  // Workout details styling
  .workout-details {
    .detail-item {
      color: var(--color-text-primary) !important;
      border-bottom: 1px solid var(--color-border) !important;
      
      .detail-label {
        color: var(--color-text-secondary) !important;
      }
      
      .detail-value {
        color: var(--color-text-primary) !important;
      }
    }
  }
  
  // Performance metrics
  .performance-comparison {
    .metric-card {
      background: var(--color-surface) !important;
      border: 1px solid var(--color-border) !important;
      
      .metric-title {
        color: var(--color-text-primary) !important;
      }
      
      .metric-planned,
      .metric-actual {
        color: var(--color-text-secondary) !important;
      }
      
      .metric-difference {
        color: var(--color-text-primary) !important;
      }
    }
  }
}

// Calendar grid and day cards - catch any missed ones
.workout-calendar,
.modern-calendar-grid,
.calendar-grid {
  // Reset any remaining white text
  * {
    &[style*="color: #fff"],
    &[style*="color: white"],
    &[style*="color: rgba(255, 255, 255"] {
      color: var(--color-text-primary) !important;
    }
  }
  
  // Day names, numbers, and descriptions
  .day-name,
  .date-number,
  .month-name,
  .workout-description,
  .workout-type,
  .workout-duration,
  .workout-stats,
  .intensity,
  .fatigue-value {
    color: var(--color-text-primary) !important;
    
    // Secondary text elements
    &.secondary {
      color: var(--color-text-secondary) !important;
    }
  }
  
  // Intensity text specifically
  .intensity {
    color: var(--color-text-secondary) !important; // Make intensity text secondary color
  }
  
  // Workout content and details
  .workout-content,
  .day-content {
    // Fix any workout-related text
    .workout-intensity,
    .intensity-level,
    .workout-zone,
    .zone-text,
    .fatigue-level,
    .effort-level {
      color: var(--color-text-secondary) !important;
    }
  }
  
  // Loading states
  .calendar-loading,
  .workout-loading {
    color: var(--color-text-secondary) !important;
  }
}

// Calendar header and controls
.calendar-header,
.calendar-controls {
  .calendar-title,
  .current-period {
    color: var(--color-text-primary) !important;
  }
  
  .calendar-subtitle {
    color: var(--color-text-secondary) !important;
  }
  
  .calendar-legend .legend-item {
    color: var(--color-text-secondary) !important;
  }
}

// Any remaining modal or popup text fixes
.modal-content,
.popup-content,
.drawer-content,
.panel-content {
  // Ensure all text is readable
  color: var(--color-text-primary);
  
  h1, h2, h3, h4, h5, h6 {
    color: var(--color-text-primary) !important;
  }
  
  p, span, div, li {
    color: var(--color-text-primary) !important;
    
    // Allow specific overrides for secondary text
    &.secondary,
    &.muted,
    &.description {
      color: var(--color-text-secondary) !important;
    }
  }
  
  // Labels and form elements
  label, .form-label {
    color: var(--color-text-primary) !important;
  }
  
  .form-help, .help-text {
    color: var(--color-text-secondary) !important;
  }
}

// High contrast mode support
@media (prefers-contrast: high) {
  .modern-day-card,
  .workout-card,
  .workout-detail-panel,
  .modal-content {
    border-width: 2px !important;
    
    &.today,
    &.center-day {
      border-width: 3px !important;
    }
  }
}